---
import { getCollection } from 'astro:content'

import Link from 'components/shared/Button/Link.astro'
import {
  colors,
  positions,
  sizes,
  space
} from 'components/shared/Button/button.tsx'

import { projectFormat } from 'lib/projectFormat'
import { CarouselHero } from './CarouselHero'
import type { ProjectProp } from 'types/type'
import AnimationFadeIn from 'components/shared/AnimationFadeIn.astro'

const [project, templates, websites] = await Promise.all([
  getCollection('project'),
  getCollection('templates'),
  getCollection('websites')
])

const formattedTemplates = projectFormat({ projects: templates, limit: 2 })
const formattedWebsites = projectFormat({ projects: websites, limit: 2 })
const projects = [
  ...(formattedTemplates as ProjectProp[]),
  ...(formattedWebsites as ProjectProp[])
]
---

<AnimationFadeIn>
  <div class="wrapper">
    <div class="translate-y-[-7.5rem]" id={project[0].data.slugs}></div>

    <CarouselHero client:load projects={projects} />

    <Link
      class={`mt-12 ${colors.primary} ${positions.center} ${sizes.small} ${space.small}`}
      href={project[0].data.link}
    >
      {project[0].data.text}
    </Link>
  </div>
</AnimationFadeIn>
